---
stand_alone: true
ipr: trust200902
cat: std # Check
submissiontype: IETF
area: Ops
wg: SIDR Operations

docname: draft-qin-sidrops-sispi-00

title: A Profile for Signed Source Address List (SiSAL)
abbrev: SiSAL
lang: en

author:
- ins: L. Qin
  name: Lancheng Qin
  org: Zhongguancun Laboratory
  city: Beijing
  country: China # use TLD (except UK) or country name
  email: qinlc@zgclab.edu.cn

normative:
  RFC6488:
  RFC6268:
  RFC3779:
  RFC6485:
  RFC6481:
  X.680:
    title: Information technology - Abstract Syntax Notation One (ASN.1)&#59; Specification of basic notation
    org: ITU-T
    date: 2021

informative:
  draft-ietf-sidrops-rpki-prefixlist:
    target: https://datatracker.ietf.org/doc/draft-ietf-sidrops-rpki-prefixlist/
    title: A profile for Signed Prefix Lists for Use in the Resource Public Key Infrastructure (RPKI)
    date: 2024


--- abstract

This document defines a "Signed Source Address List (SiSAL)", a Cryptographic Message Syntax (CMS) protected content type for use with the Resource Public Key Infrastructure (RPKI). A SiSAL is a digitally signed object which carries the complete list of IP addresses/prefixes that an Autonomous System (the subject AS) may use as the source IP address of its data packets. When validated, the eContent of a SiSAL object confirms that the holder of the subject AS produced the object, and that this list is an accurate description of IP addresses/prefixes that may be used as the source IP address of data packets generated by the subject AS. 

--- middle

# Introduction

This document defines a "Signed Source Address List (SiSAL)", a Cryptographic Message Syntax (CMS) protected content type to carry the complete list of IP addresses/prefixes that an Autonomous System (the subject AS) may use as the source IP address of its data packets. The content is signed by the holder of the RPKI private key associated with the subject AS.

Although the SiSAL object and the Signed Prefix List object {{draft-ietf-sidrops-rpki-prefixlist}}. both contain a single ASN (the subject AS) and a list of IP address prefixes, the intent of the SiSAL object is completely different from that of the Signed Prefix List object. The list of IP address prefixes in the SiSAL object specifies the addresses that may be used as the source IP address of data packets generated by the subject AS, while the list of IP address prefixes in the Signed Prefix List object specifies the prefixes that may be announced into the routing system originated by the subject AS. The IP address prefix lists of the two objects are different things.

The SiSAL object provides important and useful information for Source Address Validation (SAV). Existing SAV solutions (e.g., EFP-uRPF [RFC8704], BAR-SAV, Bicone SAV) need to know the maximal set of source IP addresses that an AS may use in its data packets. Currently, these solutions usually use BGP UPDATE, ROA, or IRR Route Object to learn this information. However, prefixes announced into the routing system and prefixes used as the source IP address in data packets may not be the same. Therefore, a dedicated object for SAV is needed.

## Requirements Language

{::boilerplate bcp14-tagged}

# The Signed Source Address List ContentType {#content}

The content-type for a SiSAL object is defined as id-ct-rpkiSiSAL, which has the numerical value of 1.2.840.113549.1.9.16.1.TBD. This OID MUST appear both within the eContentType in the encapContentInfo structure as well as the ContentType signed attribute within the signerInfo structure (see {{RFC6488}}).

# The Signed Source Address List eContent {#sav-econtent}

The content of a SiSAL object is a single ASN and a list of IP addresses/prefixes. The eContent of a SiSAL object is an instance of SignedSourceAddressList, formally defined by the following ASN.1 {{X.680}} module:

~~~~~~~~~~
RpkiSiSAL-2024
     { iso(1) member-body(2) us(840) rsadsi(113549)
       pkcs(1) pkcs9(9) smime(16) mod(0)
       id-mod-rpkiSiSAL-2024-2024(TBD0) }

DEFINITIONS EXPLICIT TAGS ::=
BEGIN

IMPORTS
  CONTENT-TYPE
  FROM CryptographicMessageSyntax-2010 -- in [RFC6268]
    { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
      pkcs-9(9) smime(16) modules(0) id-mod-cms-2009(58) } ;

ct-rpkiSiSAL CONTENT-TYPE ::=
  { TYPE SignedSourceAddressList IDENTIFIED BY id-ct-rpkiSiSAL }

id-ct-rpkiSiSAL  OBJECT IDENTIFIER ::=
  { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
    pkcs-9(9) id-smime(16) id-ct(1) TBD }

SignedSourceAddressList ::= SEQUENCE {
  version [0]   INTEGER (0..MAX) DEFAULT 0,
  asID          INTEGER (0..4294967295),
  addressBlocks  SEQUENCE OF SourceAddressFamilySourceAddressPrefixes }

SourceAddressFamilySourceAddressPrefixes ::= SEQUENCE {
  SourceAddressFamily    SOURCE-ADDRESS-FAMILY.&afi ({SourceAddressFamilySet}),
  SourceAddressPrefixes SOURCE-ADDRESS-FAMILY.&Prefixes ({SourceAddressFamilySet}{@SourceAddressFamily}) }

SOURCE-ADDRESS-FAMILY ::= CLASS {
     &afi          OCTET STRING (SIZE(2)) UNIQUE,
     &Prefixes
   } WITH SYNTAX { AFI &afi PREFIXES &Prefixes }

SourceAddressFamilySet SOURCE-ADDRESS-FAMILY ::= { SourceAddressFamilyIPv4 | SourceAddressFamilyIPv6 }

SourceAddressFamilyIPv4 SOURCE-ADDRESS-FAMILY ::= { AFI afi-IPv4 PREFIXES IPv4Prefixes }

SourceAddressFamilyIPv6 SOURCE-ADDRESS-FAMILY ::= { AFI afi-IPv6 PREFIXES IPv6Prefixes }

afi-IPv4 OCTET STRING ::= '0001'H

afi-IPv6 OCTET STRING ::= '0002'H

IPv4Prefixes ::= SEQUENCE (SIZE(1..MAX)) OF SourceAddressPrefix{ub-IPv4}

IPv6Prefixes ::= SEQUENCE (SIZE(1..MAX)) OF SourceAddressPrefix{ub-IPv6}

ub-IPv4 INTEGER ::= 32

ub-IPv6 INTEGER ::= 128

SourceAddressPrefix {INTEGER: ub} ::= BIT STRING (SIZE(0..ub))

END
~~~~~~~~~~

## version

The version number of the SignedSourceAddressList that compiles with this specification MUST be 0 and MUST be explicitly encoded.

## asID

This field contains the Autonomous System Number of the Subject AS.

## addressBlocks

This field contains a SEQUENCE of SourceAddressFamilySourceAddressPrefixes.

### Element SourceAddressFamilySourceAddressPrefixes

This field contains a SEQUENCE which contains one instance of SourceAddressFamily and one instance of SourceAddressPrefixes.

####  SourceAddressFamily

This field contains an OCTET STRING which is either '0001'H (IPv4) or '0002'H (IPv6).

#### SourceAddressPrefixes

This field contains a SEQUENCE of SourceAddressPrefix instances.

#### Element SourceAddressPrefix

This element is length bounded through the Information Object Class SOURCE-ADDRESS-FAMILY and its type is a BIT STRING.

# Signed Source Address List Validation {#validation}

To validate a SiSAL object, the relying party (RP) MUST perform all the validation checks specified in {{RFC6488}} as well as the following additional specific validation steps:

* The contents of the CMS eContent field MUST adhere to all the constraints described in {{content}}.

* The AS Identifier Delegation Extension {{RFC3779}} MUST be present in the end-entity (EE) certificate (contained within the SiSAL object), and the asID in the SiSAL object eContent MUST be contained within the set of AS numbers specified by the EE certificate's AS Identifier Delegation Extension.

* The EE certificate's AS Identifier Delegation Extension MUST NOT contain any ''inherit'' elements. 

* The IP Address Delegation Extension {{RFC3779}} MUST be absent.

# IANA Considerations {#IANA}

## RPKI Signed Object Registry

Please add an item for the SiSAL object file extension to the RPKI Signed Object registry (https://www.iana.org/assignments/rpki/rpki.xhtml#signed-objects) as follows:

~~~~~~~~~~
Name                              | OID                                    | Reference
-----------------------------------------------------------------------------------------------------
Signed Source Address List | 1.2.840.113549.1.9.16.1.TBD | draft-qin-sidrops-sisal
~~~~~~~~~~

## RPKI Repository Name Scheme Registry

Please add an item for the SiSAL object file extension to the "RPKI Repository Name Scheme" registry created by {{RFC6481}} as follows:

~~~~~~~~~~
Filename
Extension | RPKI Object                       | Reference
------------------------------------------------------------------------
   .sisal   | Signed Source Address List | draft-qin-sidrops-sisal
~~~~~~~~~~

## SMI Security for S/MIME Module Identifier (1.2.840.113549.1.9.16.0)

IANA is requested to allocate the following in the "SMI Security for S/MIME Module Identifier (1.2.840.113549.1.9.16.0)" registry:

~~~~~~~~~~
Decimal | Description                | Reference
---------------------------------------------------------------
TBD     | id-mod-rpkiSiSAL-2024 | draft-qin-sidrops-sisal
~~~~~~~~~~


## Media Type Registry

The IANA is requested to register the media type application/rpki-sisal in the "Media Type" registry as follows:

~~~~~~~~~~
Type name: application
Subtype name: rpki-sisal
Required parameters: N/A
Optional parameters: N/A
Encoding considerations: binary
Security considerations: Carries Signed Source Address List.
  This media type contains no active content. See
  Section 4 of draft-qin-sidrops-sisal for further information.
Interoperability considerations: N/A
Published specification: draft-qin-sidrops-sisal
Applications that use this media type: RPKI operators
Additional information:
  Content: This media type is a signed object, as defined
      in {{RFC6488}}, which contains a list of IP addresses/prefixes
      as defined in draft-qin-sidrops-sisal.
Magic number(s): N/A
File extension(s): .sisal
Macintosh file type code(s):
Person & email address to contact for further information:
Lancheng Qin <qinlc@mail.zgclab.edu.cn>
Intended usage: COMMON
Restrictions on usage: N/A
Change controller: IETF
~~~~~~~~~~

# Security Considerations {#security}

The security considerations of {{RFC6481}}, {{RFC6485}}, and {{RFC6488}} also apply to the SiSAL object.

# Acknowledgement